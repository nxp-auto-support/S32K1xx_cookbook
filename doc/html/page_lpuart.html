<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NXP: Low Power Universal Asynchronous Rx/Tx (LPUART)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="s32k1xx_cookbook_logo.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NXP
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">S32K1xx Series Cookbook</a></li>  </ul>
</div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Low Power Universal Asynchronous Rx/Tx (LPUART) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>Description </h2>
<p>This example performs a simple UART 9600 baud transfer to a COM port on a PC. FIFOs, interrupts and DMA are not implemented.<br />
 The Open SDA interface can be used on the evaluation board, where the UART signals are transferred to a USB interface,<br />
 which can connect to a PC which has a terminal emulation program such as PUTTY, TeraTerm or other software. <br />
 <br />
 A terminal emulator on the PC such as PuTTY can be used. To configure PuTTY:<br />
</p><ol type="1">
<li>Determine the COM port to use:<br />
<ul>
<li>Open the Windows Device Manager<br />
</li>
<li>Expand Ports (COM and LPT)<br />
</li>
<li>Note which COM port is for OpenSDA. (Example: COM3)<br />
</li>
</ul>
</li>
<li>Start PuTTY.<br />
</li>
<li>Configure the Session dialog box:<br />
<ul>
<li>Session - Connection type: Click on Serial button<br />
</li>
<li>Session - Serial line: Type in the COM port (Example: COM3)<br />
</li>
<li>Session - Speed: Enter desired baud rate (9600 in this example)<br />
</li>
</ul>
</li>
<li>Expand the Connection group (if not expanded) and select the Serial dialog box:<br />
</li>
</ol>
<ul>
<li>Connection - Serial: Verify the COM port number is correct<br />
</li>
<li>Sonnection - Serial: Set Speed (baud): 9600 in this example<br />
</li>
<li>Connection - Serial: As needed, set number of data bits, parity, stop bits, flow control<br />
</li>
</ul>
<ol type="1">
<li>Click on “Open” button to open the serial window.<br />
<br />
 <div class="image">
<img src="Diagram_LPUART_project.jpg" alt="Diagram_LPUART_project.jpg"/>
</div>
</li>
</ol>
<h2>Design </h2>
<p>Overrun handling is not included in this basic example. Hence, if data is received faster than software can<br />
 handle it, some data will be lost. If that is a concern, overrun handling logic can be added to the application.<br />
</p><ul>
<li>Disable watchdog<br />
</li>
<li>System clocks: Initialize SOSC for 8 MHz, sysclk for 80 MHz, RUN mode for 80 MHz<br />
</li>
<li>Initialize port pins:<br />
<ul>
<li>Enable clock to Port C module<br />
</li>
<li>PTC6, PTC7: Configure for LPUART1_RX, LPUART1_TX<br />
</li>
</ul>
</li>
<li>Initialize LPUART1:<br />
<ul>
<li>Enable clock source of SOSC_DIV2_CLK<br />
</li>
<li>Configure baud rate: 9600 baud, one stop bit, 8 bit characters<br />
</li>
<li>No interrupts, DMA or match features enabled<br />
</li>
<li>Configure LPUART1 control: Enable transmitter, receiver, no parity, 8 bit characters<br />
</li>
</ul>
</li>
<li>Transmit two character strings:<br />
<ul>
<li>Loop for each character to be sent: If transmit data ready status bit is set, write character to the<br />
 DATA register<br />
</li>
</ul>
</li>
<li><p class="startli">Loop to echo received characters:<br />
</p><ul>
<li>Transmit prompt character (‘&gt;’)<br />
</li>
<li>Wait for RDRF flag to be set then read character<br />
</li>
<li>Transmit read character back<br />
<br />
<h2>Pins definitions: </h2>
</li>
</ul>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">S32K14x  </th><th class="markdownTableHeadNone">LPUART1  </th><th class="markdownTableHeadNone">S32K11x  </th><th class="markdownTableHeadNone">LPSPI0   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">PTC6  </td><td class="markdownTableBodyNone">UART1 Tx  </td><td class="markdownTableBodyNone">PTB1  </td><td class="markdownTableBodyNone">UART0 Tx   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">PTC7  </td><td class="markdownTableBodyNone">UART1 Rx  </td><td class="markdownTableBodyNone">PTB0  </td><td class="markdownTableBodyNone">UART0 Rx   </td></tr>
</table>
</li>
</ul>
<p><br />
</p><h2>Driver Functions (S32K14x): </h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Function  </th><th class="markdownTableHeadNone">Driver   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="_l_p_u_a_r_t_8h.html#a735e25c9d923840ffb8b3f25e90f54c6">LPUART1_init</a>  </td><td class="markdownTableBodyNone">LPUART   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="_l_p_u_a_r_t_8h.html#afffea491e64bb00b6c8fd6bde67dff6e">LPUART1_transmit_char</a>  </td><td class="markdownTableBodyNone">LPUART   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="_l_p_u_a_r_t_8h.html#a13bfec91c1a423ccb71fcfed397c25d1">LPUART1_transmit_string</a>  </td><td class="markdownTableBodyNone">LPUART   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="_l_p_u_a_r_t_8h.html#a556289ca43dede22a5d0426adfeffa81">LPUART1_receive_char</a>  </td><td class="markdownTableBodyNone">LPUART   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><a class="el" href="_l_p_u_a_r_t_8h.html#a964c616e2505a648e4c42deba01d7ae0">LPUART1_receive_and_echo_char</a>  </td><td class="markdownTableBodyNone">LPUART   </td></tr>
</table>
<p><br />
</p><h2>main.c </h2>
<div class="fragment"><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * Description:</span></div><div class="line"><span class="comment"> * ==========================================================================================</span></div><div class="line"><span class="comment"> * This example performs a simple UART transfer to a COM port on a PC. FIFOs, interrupts and</span></div><div class="line"><span class="comment"> * DMA are not implemented. The Open SDA interface can be used on the evaluation board, where </span></div><div class="line"><span class="comment"> * the UART signals are transferred to a USB interface, which can connect to a PC which has a </span></div><div class="line"><span class="comment"> * terminal emulation program such as PUTTY, TeraTerm or other software.</span></div><div class="line"><span class="comment"> * */</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;device_registers.h&quot;</span> <span class="comment">/* include peripheral declarations S32K144 */</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="clocks__and__modes_8h.html">clocks_and_modes.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="_l_p_u_a_r_t_8h.html">LPUART.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="keywordtype">char</span> <a class="code" href="main__uart_8c.html#a0f11fc08c1ec2c8146ddd0d5b8fe8355">data</a>=0;</div><div class="line"><span class="keywordtype">void</span> <a class="code" href="main__adc_8c.html#a5a63998141f65a3976c1063796113c79">PORT_init</a> (<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">    <span class="comment">/*</span></div><div class="line"><span class="comment">     * Pins definitions</span></div><div class="line"><span class="comment">     * ===================================================</span></div><div class="line"><span class="comment">     *</span></div><div class="line"><span class="comment">     * Pin number        | Function</span></div><div class="line"><span class="comment">     * ----------------- |------------------</span></div><div class="line"><span class="comment">     * PTC6              | UART1 TX</span></div><div class="line"><span class="comment">     * PTC7              | UART1 RX</span></div><div class="line"><span class="comment">     */</span></div><div class="line">  PCC-&gt;PCCn[PCC_PORTC_INDEX ]|=PCC_PCCn_CGC_MASK; <span class="comment">/* Enable clock for PORTC */</span></div><div class="line">  PORTC-&gt;PCR[6]|=PORT_PCR_MUX(2);   <span class="comment">/* Port C6: MUX = ALT2, UART1 TX */</span></div><div class="line">  PORTC-&gt;PCR[7]|=PORT_PCR_MUX(2);   <span class="comment">/* Port C7: MUX = ALT2, UART1 RX */</span></div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> <a class="code" href="main__adc_8c.html#ae8c3a22d3a6885669bf758d848dd0f49">WDOG_disable</a> (<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">  WDOG-&gt;CNT=0xD928C520;     <span class="comment">/* Unlock watchdog      */</span></div><div class="line">  WDOG-&gt;TOVAL=0x0000FFFF;   <span class="comment">/* Maximum timeout value    */</span></div><div class="line">  WDOG-&gt;CS = 0x00002100;    <span class="comment">/* Disable watchdog         */</span></div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> <a class="code" href="main__adc_8c.html#a840291bc02cba5474a4cb46a9b9566fe">main</a>(<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">    <span class="comment">/*</span></div><div class="line"><span class="comment">     * Initialization:</span></div><div class="line"><span class="comment">     * =======================</span></div><div class="line"><span class="comment">     */</span></div><div class="line">  <a class="code" href="main__adc_8c.html#ae8c3a22d3a6885669bf758d848dd0f49">WDOG_disable</a>();        <span class="comment">/* Disable WDOG */</span></div><div class="line">  <a class="code" href="clocks__and__modes_8c.html#a2f05a0e5aa290fba55984156198f14a2">SOSC_init_8MHz</a>();      <span class="comment">/* Initialize system oscilator for 8 MHz xtal */</span></div><div class="line">  <a class="code" href="clocks__and__modes_8c.html#a5b337515ef6255432800f7793441527c">SPLL_init_160MHz</a>();    <span class="comment">/* Initialize SPLL to 160 MHz with 8 MHz SOSC */</span></div><div class="line">  <a class="code" href="clocks__and__modes_8c.html#aa234261bbd2c76d65303e209757dc19b">NormalRUNmode_80MHz</a>(); <span class="comment">/* Init clocks: 80 MHz sysclk &amp; core, 40 MHz bus, 20 MHz flash */</span></div><div class="line">  <a class="code" href="main__adc_8c.html#a5a63998141f65a3976c1063796113c79">PORT_init</a>();           <span class="comment">/* Configure ports */</span></div><div class="line"></div><div class="line">  <a class="code" href="_l_p_u_a_r_t_8c.html#a735e25c9d923840ffb8b3f25e90f54c6">LPUART1_init</a>();        <span class="comment">/* Initialize LPUART @ 9600*/</span></div><div class="line">  <a class="code" href="_l_p_u_a_r_t_8c.html#a13bfec91c1a423ccb71fcfed397c25d1">LPUART1_transmit_string</a>(<span class="stringliteral">&quot;Running LPUART example\n\r&quot;</span>);     <span class="comment">/* Transmit char string */</span></div><div class="line">  <a class="code" href="_l_p_u_a_r_t_8c.html#a13bfec91c1a423ccb71fcfed397c25d1">LPUART1_transmit_string</a>(<span class="stringliteral">&quot;Input character to echo...\n\r&quot;</span>); <span class="comment">/* Transmit char string */</span></div><div class="line"></div><div class="line">    <span class="comment">/*</span></div><div class="line"><span class="comment">     * Infinite for:</span></div><div class="line"><span class="comment">     * ========================</span></div><div class="line"><span class="comment">     */</span></div><div class="line">      <span class="keywordflow">for</span>(;;)</div><div class="line">      {</div><div class="line">          <a class="code" href="_l_p_u_a_r_t_8c.html#afffea491e64bb00b6c8fd6bde67dff6e">LPUART1_transmit_char</a>(<span class="charliteral">&#39;&gt;&#39;</span>);       <span class="comment">/* Transmit prompt character*/</span></div><div class="line">          <a class="code" href="_l_p_u_a_r_t_8c.html#a964c616e2505a648e4c42deba01d7ae0">LPUART1_receive_and_echo_char</a>();  <span class="comment">/* Wait for input char, receive &amp; echo it*/</span></div><div class="line">      }</div><div class="line">}</div><div class="line"></div><div class="line"></div></div><!-- fragment --> </div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
